# 投票选举管理系统

## 项目简介

本项目是一个基于C++ STL（标准模板库）实现的投票选举管理系统，用于解决投票选举问题。系统采用模块化设计，功能完整，界面美观，操作方便。

## 功能特性

### 基本功能

1. **候选人管理**
   - 添加候选人（编号、姓名、所属单位）
   - 修改候选人信息
   - 删除候选人
   - 查询候选人
   - 显示所有候选人列表

2. **投票管理**
   - 单票投票
   - 批量投票（输入投票向量）
   - 从文件导入投票数据
   - 查看投票历史
   - 重置投票

3. **查询统计**
   - 得票统计（显示得票数和得票率）
   - 按得票数排序（升序/降序）
   - 按编号排序
   - 按姓名排序
   - 统计摘要（总数、平均、最高、最低）

4. **选举结果**
   - 自动计算优胜者（超过半数选票的候选人）
   - 显示详细的选举结果

5. **数据维护**
   - 保存候选人数据到文件
   - 加载候选人数据
   - 保存投票数据到文件
   - 加载投票数据
   - 导出统计报告（文本格式）
   - 清空所有数据

6. **高级功能**
   - 投票数据分析
   - 候选人排名分析
   - 得票分布可视化

### 数据验证

- 候选人ID必须为正整数
- 候选人姓名不能为空且长度不超过50字符
- 检测并拒绝重复的候选人ID
- 检测并报告无效的投票ID
- 输入数据合法性验证

### 文件管理

- 二进制格式保存候选人数据（高效）
- 文本格式保存投票向量（易读）
- 导出格式化的统计报告

## 技术特点

### 使用的STL容器

1. **vector<Candidate>** - 存储候选人列表
2. **unordered_map<int, int>** - ID到索引的快速映射
3. **vector<int>** - 存储投票向量和历史记录
4. **map<int, int>** - 用于统计和排序

### 算法设计

**优胜者查找算法**：
- 时间复杂度：O(n)，其中n是候选人数量
- 空间复杂度：O(1)
- 直接遍历所有候选人，查找得票数超过总票数一半的候选人

### 模块化设计

1. **Candidate** - 候选人数据结构
2. **DataValidator** - 数据验证模块
3. **FileManager** - 文件管理模块
4. **Statistics** - 统计功能模块
5. **ElectionSystem** - 核心选举系统
6. **UI** - 用户界面模块

## 编译和运行

本项目提供两个版本：
1. **控制台版本** - 基于文本的交互式界面
2. **GUI版本** - 基于Qt的图形用户界面（推荐）

### 控制台版本

#### 编译

```bash
# 使用Makefile（推荐）
make console

# 或手动编译
g++ -std=c++11 -Iinclude -o election_console src/main.cpp src/election_core.cpp
```

#### 运行

```bash
./election_console
```

运行后可以选择：
- **模式1**：交互式界面（推荐）
- **模式2**：运行测试用例

### GUI版本（推荐）

#### 系统要求

- Qt5 开发库（Qt5.7或更高版本）
- C++11或更高版本的编译器

#### 安装Qt5（Ubuntu/Debian）

```bash
sudo apt-get update
sudo apt-get install qt5-default
# 或
sudo apt-get install qtbase5-dev qt5-qmake
```

#### 编译方法1：使用qmake（推荐）

```bash
qmake election_gui.pro
make
```

#### 编译方法2：使用CMake

```bash
mkdir build
cd build
cmake ..
make
```

#### 编译方法3：使用Makefile

```bash
make gui
```

#### 运行GUI版本

```bash
./election_gui
# 或（如果使用CMake）
./build/bin/election_gui
```

#### GUI版本特性

- **美观的图形界面** - 现代化的Qt界面设计
- **标签页组织** - 功能模块清晰分类
- **实时数据更新** - 操作后自动刷新显示
- **数据可视化** - 表格、统计摘要、得票分布
- **文件对话框** - 方便的文件选择和管理
- **操作日志** - 记录所有数据维护操作

## 使用示例

### 示例1：基本投票流程

1. 启动程序，选择交互式界面
2. 进入"候选人管理" → "添加候选人"
   - 添加编号1，姓名"张三"，单位"计算机学院"
   - 添加编号2，姓名"李四"，单位"数学学院"
   - 添加编号3，姓名"王五"，单位"物理学院"
3. 进入"投票管理" → "批量投票"
   - 输入投票向量：`1 2 1 3 1 1 1 2 1 1 -1`
4. 进入"选举结果"查看优胜者

### 示例2：从文件导入

1. 创建投票文件 `votes.dat`，内容为：
   ```
   1 2 1 3 1 1 1 2 1 1
   ```
2. 在程序中进入"投票管理" → "从文件导入投票"
3. 输入文件名：`votes.dat`

### 示例3：导出报告

1. 完成投票后，进入"数据维护" → "导出统计报告"
2. 报告将保存到 `election_report.txt`

## 测试用例

程序内置了多个测试用例，包括：

1. **基本功能测试** - 验证超过半数选票的候选人能被正确识别
2. **边界情况测试** - 验证没有超过半数候选人的情况
3. **数据验证测试** - 验证无效输入的处理
4. **无效投票处理** - 验证系统对无效投票的容错能力

运行测试用例：
```bash
./election
# 选择模式2
```

## 性能分析

详见 `PERFORMANCE_ANALYSIS.md` 文件。

### 时间复杂度总结

- **添加候选人**：O(1) 平均，O(n) 最坏（哈希冲突）
- **删除候选人**：O(n)（需要重建索引）
- **查询候选人**：O(1) 平均
- **投票**：O(m)，其中m是投票向量长度
- **查找优胜者**：O(n)，其中n是候选人数量
- **排序**：O(n log n)

### 空间复杂度总结

- **候选人存储**：O(n)
- **投票历史**：O(m)
- **索引映射**：O(n)
- **总体空间复杂度**：O(n + m)

## 创新点

1. **模块化设计** - 清晰的模块划分，易于维护和扩展
2. **数据验证** - 完善的输入验证机制，防止非法数据
3. **文件持久化** - 支持数据的保存和加载
4. **可视化分析** - 得票分布的可视化显示
5. **用户友好界面** - 美观的菜单系统和格式化输出
6. **测试用例** - 内置完整的测试用例

## 文件说明

### 目录结构

```
code2/
├── include/              # 头文件目录
│   ├── election_core.h   # 核心选举系统头文件
│   └── gui_mainwindow.h  # GUI主窗口头文件
├── src/                  # 源文件目录
│   ├── election_core.cpp  # 核心选举系统实现
│   ├── main.cpp          # 控制台版本主程序
│   ├── gui_main.cpp      # GUI版本主程序
│   └── gui_mainwindow.cpp # GUI主窗口实现
├── election_gui.pro      # Qt项目文件
├── CMakeLists.txt        # CMake项目文件
├── Makefile              # 通用Makefile
└── ...                   # 其他文档文件
```

### 核心文件
- `include/election_core.h` / `src/election_core.cpp` - 核心选举系统（供GUI和控制台版本共用）
- `src/main.cpp` - 控制台版本主程序
- `src/gui_main.cpp` - GUI版本主程序
- `include/gui_mainwindow.h` / `src/gui_mainwindow.cpp` - GUI主窗口实现

### 项目配置文件
- `election_gui.pro` - Qt项目文件（qmake）
- `CMakeLists.txt` - CMake项目文件
- `Makefile` - 通用Makefile（支持控制台和GUI版本）

### 文档文件
- `README.md` - 本文件，项目说明文档
- `PERFORMANCE_ANALYSIS.md` - 性能分析报告
- `CODE_REVIEW.md` - 代码审查报告

### 数据文件（运行时生成）
- `candidates.dat` - 候选人数据文件
- `votes.dat` - 投票数据文件
- `election_report.txt` - 统计报告文件

## 系统要求

### 控制台版本
- C++11 或更高版本
- 支持STL标准库
- Linux/Windows/macOS 操作系统

### GUI版本
- C++11 或更高版本
- Qt5.7 或更高版本
- 支持STL标准库
- Linux/Windows/macOS 操作系统

## 作者

研究性学习与创新性设计项目

## 版本历史

- **v2.0** (2024) - GUI版本
  - 新增基于Qt的图形用户界面
  - 代码重构，核心模块独立
  - 支持控制台和GUI双版本
  - 改进的用户体验和界面设计
  - 完整的项目配置文件（qmake、CMake、Makefile）

- **v1.0** (2024) - 初始版本
  - 实现基本投票选举功能
  - 模块化设计
  - 完整的控制台用户界面
  - 数据验证和文件管理
  - 高级统计分析功能

